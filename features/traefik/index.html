
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Erase environment differences, make developers happy !">
      
      
      
        <meta name="author" content="RÃ©mi Alvergnat <remi.alvergnat@gfi.world>, Pierre Lejeune <pierre.lejeune@gfi.world>">
      
      
        <link rel="canonical" href="https://gfi-centre-ouest.github.io/docker-devbox-ddb/features/traefik/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>traefik - ddb (for Docker Devbox)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#traefik" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://gfi-centre-ouest.github.io/docker-devbox-ddb" title="ddb (for Docker Devbox)" class="md-header-nav__button md-logo" aria-label="ddb (for Docker Devbox)">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            ddb (for Docker Devbox)
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              traefik
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/gfi-centre-ouest/docker-devbox-ddb/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://gfi-centre-ouest.github.io/docker-devbox-ddb" title="ddb (for Docker Devbox)" class="md-nav__button md-logo" aria-label="ddb (for Docker Devbox)">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ddb (for Docker Devbox)
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/gfi-centre-ouest/docker-devbox-ddb/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        Guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/psql-symfony-vue/" class="md-nav__link">
        PostgreSQL, Symfony, VueJS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
      
      <label class="md-nav__link" for="nav-7">
        Features
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Features" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../certs/" class="md-nav__link">
        certs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../copy/" class="md-nav__link">
        copy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        core
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        docker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../file/" class="md-nav__link">
        file
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fixuid/" class="md-nav__link">
        fixuid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../gitignore/" class="md-nav__link">
        gitignore
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jinja/" class="md-nav__link">
        jinja
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../jsonnet/" class="md-nav__link">
        jsonnet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../permissions/" class="md-nav__link">
        permissions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../run/" class="md-nav__link">
        run
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../shell/" class="md-nav__link">
        shell
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../smartcd/" class="md-nav__link">
        smartcd
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../symlinks/" class="md-nav__link">
        symlinks
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          traefik
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        traefik
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#include-a-service-running-outside-of-docker-compose" class="md-nav__link">
    Include a service running outside of docker compose
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-certificates-feature" class="md-nav__link">
    Custom certificates feature
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../version/" class="md-nav__link">
        version
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ytt/" class="md-nav__link">
        ytt
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#include-a-service-running-outside-of-docker-compose" class="md-nav__link">
    Include a service running outside of docker compose
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-certificates-feature" class="md-nav__link">
    Custom certificates feature
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/gfi-centre-ouest/docker-devbox-ddb/blob/develop/docs/features/traefik.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="traefik">Traefik<a class="headerlink" href="#traefik" title="Permanent link">&para;</a></h1>
<p>One component which we often use on our dev environment is <a href="https://containo.us/traefik/">Traefik</a> as reverse proxy.
It allows us to run dockerized projects and access them in our browser using <code>project.test</code> as DNS for example.</p>
<p>The feature does not install traefik or handle the configuration of your host to map the DNS entry to the IP,
but it handles the generation of traefik configuration file for your project if there is certificates for HTTPS 
access.</p>
<div class="admonition summary">
<p class="admonition-title">Feature configuration (prefixed with <code>traefik.</code>)</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Simple</label><div class="tabbed-content">
<table>
<thead>
<tr>
<th align="center">Property</th>
<th align="center">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>disabled</code></td>
<td align="center">boolean<br><code>false</code></td>
<td align="left">Should this feature be disabled ?</td>
</tr>
<tr>
<td align="center"><code>extra_services</code></td>
<td align="center">dict[string, <strong>ExtraService</strong>]<br><code>[]</code></td>
<td align="left">A dict of ExtraService configuration.</td>
</tr>
</tbody>
</table>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Advanced</label><div class="tabbed-content">
<table>
<thead>
<tr>
<th align="center">Property</th>
<th align="center">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>certs_directory</code></td>
<td align="center">string<br><code>${core.path.home}/certs</code></td>
<td align="left">Custom certificates location.</td>
</tr>
<tr>
<td align="center"><code>mapped_certs_directory</code></td>
<td align="center">string<br><code>${core.path.home}/certs</code></td>
<td align="left">Traefik container custom certificates location.</td>
</tr>
<tr>
<td align="center"><code>config_directory</code></td>
<td align="center">string<br><code>${core.path.home}/traefik/config</code></td>
<td align="left">Traefik configuration directory.</td>
</tr>
<tr>
<td align="center"><code>ssl_config_template</code></td>
<td align="center">string<br><code>&lt;Jinja template&gt;</code></td>
<td align="left">The Jinja template for the traefik configuration file registering CFSSL SSL certificates. This template can be a template string, or a link to a file containing the template, prefixed with <code>http(s)://</code> for web files, or <code>file://</code> for local ones.</td>
</tr>
<tr>
<td align="center"><code>extra_services_config_template</code></td>
<td align="center">string<br><code>&lt;Jinja template&gt;</code></td>
<td align="left">The Jinja template for extra-services configuration file. This template can be a template string, or a link to a file containing the template, prefixed with <code>http(s)://</code> for web files, or <code>file://</code> for local ones.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition summary">
<p class="admonition-title">ExtraService configuration (used in <code>traefik.extra_services</code>)</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Simple</label><div class="tabbed-content">
<table>
<thead>
<tr>
<th align="center">Property</th>
<th align="center">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>domain</code></td>
<td align="center">string<span style="color:red">*</span></td>
<td align="left">Domain to use for SSL certificate generation.</td>
</tr>
<tr>
<td align="center"><code>url</code></td>
<td align="center">string<span style="color:red">*</span></td>
<td align="left">URL to access the service to proxy from traefik container.</td>
</tr>
<tr>
<td align="center"><code>https</code></td>
<td align="center">boolean</td>
<td align="left">Use http and/or https to expose the service. If <code>None</code>, it is exposed with both http and https.</td>
</tr>
<tr>
<td align="center"><code>redirect_to_https</code></td>
<td align="center">boolean<br><code>${docker.reverse_proxy.redirect_to_https}</code></td>
<td align="left">If <code>https</code> is <code>None</code> and <code>redirect_to_https</code> is <code>True</code>, requesting the http url of the service will reply with a temporary redirect to https.</td>
</tr>
</tbody>
</table>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Advanced</label><div class="tabbed-content">
<table>
<thead>
<tr>
<th align="center">Property</th>
<th align="center">Type</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>path_prefix</code></td>
<td align="center">string</td>
<td align="left">The traefik prefix path. You should customize it only if you have to support sub folder on the domain.</td>
</tr>
<tr>
<td align="center"><code>redirect_to_path_prefix</code></td>
<td align="center">boolean</td>
<td align="left">The traefik prefix path. You should customize it only if you have to support sub folder on the domain.</td>
</tr>
<tr>
<td align="center"><code>rule</code></td>
<td align="center">string<br><code>Host(`{{_local.domain}}`)</code></td>
<td align="left">Custom certificates location.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition quote">
<p class="admonition-title">Defaults</p>
<div class="highlight"><pre><span></span><code><span class="nt">traefik</span><span class="p">:</span>
  <span class="nt">certs_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/toilal/.docker-devbox/certs</span>
  <span class="nt">mapped_certs_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/certs</span>
  <span class="nt">config_directory</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/home/toilal/.docker-devbox/traefik/config</span>
  <span class="nt">disabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">extra_services</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">extra_services_config_template</span><span class="p">:</span> <span class="s">&quot;#</span><span class="nv"> </span><span class="s">This</span><span class="nv"> </span><span class="s">configuration</span><span class="nv"> </span><span class="s">file</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">automatically\</span>
    <span class="s">\ generated</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">ddb\n[http.routers]\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">none</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">_local.https\</span>
    <span class="s">\ is</span><span class="nv"> </span><span class="s">sameas</span><span class="nv"> </span><span class="s">false</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">[http.routers.extra-service-{{_local.id}}]\n</span><span class="nv">    </span><span class="s">rule</span><span class="nv"> </span><span class="s">=\</span>
    <span class="s">\ \&quot;{{_local.rule}}\&quot;{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">_local.redirect_to_https</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">_local.path_prefix\</span>
    <span class="s">\ %}</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">\&quot;PathPrefix(`{{_local.path_prefix}}{regex:$$|/.*}`)\&quot;{%</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">\</span>
    <span class="s">\ </span><span class="nv"> </span><span class="s">entrypoints</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;http\&quot;]\n</span><span class="nv">    </span><span class="s">service</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;extra-service-{{_local.id}}\&quot;\n{%-\</span>
    <span class="s">\ if</span><span class="nv"> </span><span class="s">_local.redirect_to_https</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">    </span><span class="s">middlewares</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;extra-service-{{_local.id}}-redirect-to-https\&quot;\</span>
    <span class="s">]\n{%-</span><span class="nv"> </span><span class="s">elif</span><span class="nv"> </span><span class="s">_local.path_prefix</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">    </span><span class="s">middlewares</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;extra-service-{{_local.id}}-stripprefix\&quot;\</span>
    <span class="s">]\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">none</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is\</span>
    <span class="s">\ sameas</span><span class="nv"> </span><span class="s">true</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">[http.routers.extra-service-{{_local.id}}-tls]\n</span><span class="nv">    </span><span class="s">rule</span><span class="nv"> </span><span class="s">=\</span>
    <span class="s">\ \&quot;{{_local.rule}}{%</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.path_prefix</span><span class="nv"> </span><span class="s">%}</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">PathPrefix(`{{_local.path_prefix}}{regex:$$|/.*}`){%\</span>
    <span class="s">\ endif</span><span class="nv"> </span><span class="s">%}\&quot;\n</span><span class="nv">    </span><span class="s">entrypoints</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;https\&quot;]\n</span><span class="nv">    </span><span class="s">tls</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">true\n</span><span class="nv">    </span><span class="s">service</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;\</span>
    <span class="s">extra-service-{{_local.id}}\&quot;\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.path_prefix</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">    </span><span class="s">middlewares</span><span class="nv"> </span><span class="s">=\</span>
    <span class="s">\ [\&quot;extra-service-{{_local.id}}-stripprefix\&quot;]\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.certresolver\</span>
    <span class="s">\ is</span><span class="nv"> </span><span class="s">defined</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">    </span><span class="s">[http.routers.extra-service-{{_local.service}}-tls.tls]\n\</span>
    <span class="s">\ </span><span class="nv">     </span><span class="s">certResolver</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.certresolver}}\&quot;\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n\</span>
    <span class="s">{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.redirect_to_path_prefix</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">none</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">not\</span>
    <span class="s">\ _local.redirect_to_https</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">sameas</span><span class="nv"> </span><span class="s">false</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">[http.routers.extra-service-{{_local.id}}-redirect-to-path-prefix]\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">rule</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.rule}}\&quot;\n</span><span class="nv">    </span><span class="s">entrypoints</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;http\&quot;]\n</span><span class="nv">    </span><span class="s">service</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;\</span>
    <span class="s">extra-service-{{_local.id}}\&quot;\n</span><span class="nv">    </span><span class="s">middlewares</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;extra-service-{{_local.id}}-redirect-to-path-prefix\&quot;\</span>
    <span class="s">]\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">none</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">_local.https</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">sameas</span><span class="nv"> </span><span class="s">true</span><span class="nv"> </span><span class="s">%}\n\</span>
    <span class="s">\ </span><span class="nv"> </span><span class="s">[http.routers.extra-service-{{_local.id}}-redirect-to-path-prefix-tls]\n</span><span class="nv">  </span><span class="s">\</span>
    <span class="s">\ </span><span class="nv"> </span><span class="s">rule</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.rule}}\&quot;\n</span><span class="nv">    </span><span class="s">entrypoints</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;https\&quot;]\n</span><span class="nv">    </span><span class="s">tls</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">true\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">service</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;extra-service-{{_local.id}}\&quot;\n</span><span class="nv">    </span><span class="s">middlewares</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">[\&quot;extra-service-{{_local.id}}-redirect-to-path-prefix\&quot;\</span>
    <span class="s">]\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.certresolver</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">defined</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">    </span><span class="s">[http.routers.extra-service-{{_local.service}}-tls.tls]\n\</span>
    <span class="s">\ </span><span class="nv">     </span><span class="s">certResolver</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.certresolver}}\&quot;\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n\</span>
    <span class="s">{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.redirect_to_https</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">_local.path_prefix</span><span class="nv">  </span><span class="s">%}\n\n\</span>
    <span class="s">[http.middlewares]\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.redirect_to_https</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">[http.middlewares.extra-service-{{_local.id}}-redirect-to-https.redirectScheme]\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">scheme</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;https\&quot;\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.path_prefix</span><span class="nv"> </span><span class="s">%}\n</span><span class="nv">  </span><span class="s">[http.middlewares.extra-service-{{_local.id}}-stripprefix.stripPrefix]\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">prefixes</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.path_prefix}}\&quot;\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n{%-</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">_local.redirect_to_path_prefix\</span>
    <span class="s">\ %}\n</span><span class="nv">  </span><span class="s">[http.middlewares.extra-service-{{_local.id}}-redirect-to-path-prefix.redirectregex]\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">regex</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;^.*$\&quot;\n</span><span class="nv">    </span><span class="s">replacement</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.path_prefix}}\&quot;\n{%-</span><span class="nv"> </span><span class="s">endif\</span>
    <span class="s">\ %}\n{%-</span><span class="nv"> </span><span class="s">endif</span><span class="nv"> </span><span class="s">%}\n\n[http.services]\n</span><span class="nv">  </span><span class="s">[http.services.extra-service-{{_local.id}}]\n\</span>
    <span class="s">\ </span><span class="nv">   </span><span class="s">[http.services.extra-service-{{_local.id}}.loadBalancer]\n</span><span class="nv">      </span><span class="s">[[http.services.extra-service-{{_local.id}}.loadBalancer.servers]]\n\</span>
    <span class="s">\ </span><span class="nv">       </span><span class="s">url</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.url}}\&quot;\n\n&quot;</span>
  <span class="nt">ssl_config_template</span><span class="p">:</span> <span class="s">&quot;#</span><span class="nv"> </span><span class="s">This</span><span class="nv"> </span><span class="s">configuration</span><span class="nv"> </span><span class="s">file</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">automatically</span><span class="nv"> </span><span class="s">generated\</span>
    <span class="s">\ by</span><span class="nv"> </span><span class="s">ddb\n[[tls.certificates]]\n</span><span class="nv">  </span><span class="s">certFile</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">\&quot;{{_local.certFile}}\&quot;\n</span><span class="nv">  </span><span class="s">keyFile\</span>
    <span class="s">\ =</span><span class="nv"> </span><span class="s">\&quot;{{_local.keyFile}}\&quot;\n\n&quot;</span>
</code></pre></div>
</div>
<h2 id="include-a-service-running-outside-of-docker-compose">Include a service running outside of docker compose<a class="headerlink" href="#include-a-service-running-outside-of-docker-compose" title="Permanent link">&para;</a></h2>
<p>If you need to register an external service into your docker network, you should define an <code>external_service</code> entry.</p>
<p>It can be used when a service is running outside the docker network, like on another Machine or on the developer host.</p>
<p>Declared extra services make them join the docker network so it behaves like a docker compose service and brings all 
traefik reverse-proxy features (SSL support, domain name, ...).</p>
<p>Jinja templating is available for <code>url</code>, <code>domain</code> and <code>rule</code> fields, with the usual configuration as data context, 
and additional <code>_local</code> dict containing the extra_service entry configuration.</p>
<div class="admonition example">
<p class="admonition-title">Bring back a dockerized service inside your IDE</p>
<p>Running the server component inside the developer editor may more convenient in some cases.</p>
<p>If the application is running on port 8080 right on the host, you can write this kind of configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">traefik</span><span class="p">:</span>
  <span class="nt">extra_services</span><span class="p">:</span>
    <span class="nt">api</span><span class="p">:</span>
      <span class="nt">domain</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.{{core.domain.sub}}.{{core.domain.ext}}</span>
      <span class="nt">url</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">http://{{docker.debug.host}}:8080</span>
</code></pre></div>
<p>It will expose the server component throw the traefik docker network, with the domain name and HTTPS support.</p>
</div>
<h2 id="custom-certificates-feature">Custom certificates feature<a class="headerlink" href="#custom-certificates-feature" title="Permanent link">&para;</a></h2>
<p>If your project have certificates for SSL access, Traefik needs a bit a configuration in order to use them.</p>
<p>This is done on <code>ddb configure</code> command. For instance, if your have set <code>docker.reverse-proxy.certresolver</code> with <code>null</code> 
value in your <code>docker-compose.yml.jsonnet</code> (check feature <a href="../jsonnet/">jsonnet</a> for more details), 
it will create a label <code>ddb.emit.certs:generate: &lt;domain&gt;</code>.</p>
<p>This label emit a <code>certs:generate</code> for given <code>domain</code>, and it is processed by <a href="../certs/">certs</a> feature to generate a 
custom SSL certificate.</p>
<p>Then, <code>certs:available</code> event is triggered and handled by traefik feature to install this certificate in the 
traefik configuration for given <code>domain</code>.</p>
<p>For some reason, you might want to remove HTTPS on your project and move back to HTTP. </p>
<p>This is done on <code>ddb configure</code> command.
If you define <code>docker.reverse-proxy.certresolver</code> value to 'letsencrypt', or set <code>traefik.https</code> to <code>False</code>, it is 
detected that you removed it. </p>
<p>The <code>certs:remove</code> event is then triggered and handled by <a href="../certs/">certs</a> feature to remove it.</p>
<p>Then, <code>certs:removed</code> event is triggered and handler by traefik feature to uninstall this certificate from traefik 
configuration, so there's no more certificate defined for the given domain.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../symlinks/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                symlinks
              </div>
            </div>
          </a>
        
        
          <a href="../version/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                version
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            GFI Informatique
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>